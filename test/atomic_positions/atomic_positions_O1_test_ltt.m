function yy=atomic_positions_O1_test_ltt(xx)
% Function to calculate the position of each atom in the unit cell by
% knowing the undistorted coordinates, the distortion-mode amplitude xx,
% and the distortion modes.
% The position is expressed in the fractional coordinates of the supercell.
% The matrixes are orginized as:
% undist = #atoms x (x,y,z)
% xx = 1 x #modes
% dist = #atoms x (x,y,z)
% In the script, each row of dist is expressed as a sum of the modes for
% each atom in the unit cell. The normalization factor for each mode is
% directly expressed as a number.

undist = [
 0.003700 0.625000 0.500000;
 0.003700 0.375000 0.000000;
 0.503700 0.875000 0.000000;
 0.503700 0.125000 0.500000;
 0.996300 0.375000 0.500000;
 0.996300 0.625000 0.000000;
 0.496300 0.875000 0.500000;
 0.496300 0.125000 0.000000;
 0.003700 0.875000 0.000000;
 0.003700 0.125000 0.500000;
 0.503700 0.625000 0.500000;
 0.503700 0.375000 0.000000;
 0.996300 0.875000 0.500000;
 0.996300 0.125000 0.000000;
 0.496300 0.375000 0.500000;
 0.496300 0.625000 0.000000;
 0.746300 0.375000 0.500000;
 0.746300 0.625000 0.000000;
 0.246300 0.875000 0.500000;
 0.246300 0.125000 0.000000;
 0.253700 0.375000 0.000000;
 0.253700 0.625000 0.500000;
 0.753700 0.875000 0.000000;
 0.753700 0.125000 0.500000;
 0.746300 0.875000 0.500000;
 0.746300 0.125000 0.000000;
 0.246300 0.375000 0.500000;
 0.246300 0.625000 0.000000;
 0.253700 0.875000 0.000000;
 0.253700 0.125000 0.500000;
 0.753700 0.375000 0.000000;
 0.753700 0.625000 0.500000;
];

% The following modes are considered:
% P4_2/ncm[1/4,1/4,1/2]S1(a,0;0,0)[O1:e:dsp]A1_1(a) normfactor = 0.01339
% P4_2/ncm[1/4,1/4,1/2]S1(a,0;0,0)[O1:e:dsp]A1_2(a) normfactor = 0.01339
% P4_2/ncm[1/4,1/4,1/2]S1(a,0;0,0)[O1:e:dsp]B2(a) normfactor = 0.02336
% P4_2/ncm[1/4,1/4,1/2]S1(a,0;0,0)[O1:e:dsp]B1(a) normfactor = 0.02336
% P4_2/ncm[0,0,0]GM1+(a)[O1:e:dsp]A1(a) normfactor = 0.00947
% P4_2/ncm[0,0,0]GM4+(a)[O1:e:dsp]A1(a) normfactor = 0.00947
% P4_2/ncm[1/2,1/2,0]M2(0,a)[O1:e:dsp]B2(a) normfactor = 0.02336
% P4_2/ncm[1/2,1/2,0]M2(0,a)[O1:e:dsp]B1(a) normfactor = 0.02336

dist = [
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  1.000000  0.000000];
xx(1) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000 -1.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [ 1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000 -1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
xx(1) *  0.013390 * [ 0.000000  0.000000  0.000000] + xx(2) *  0.013390 * [-1.000000  0.000000  0.000000] + xx(3) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(4) *  0.023360 * [ 0.000000  0.000000  0.000000] + xx(5) *  0.009470 * [ 1.000000  0.000000  0.000000] + xx(6) *  0.009470 * [-1.000000  0.000000  0.000000] + xx(7) *  0.023360 * [ 0.000000  1.000000  0.000000] + xx(8) *  0.023360 * [ 0.000000  0.000000  0.000000];
];

yy = undist + dist;

end